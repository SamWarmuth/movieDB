- params[:key]="title" if params[:key].nil?
- movies = Movie.all(:order =>[params[:key].to_sym.asc])
-load_limit = 0
%h1
	Movies
	(#{movies.count})
%p
	%a{:href => "/movies"}List View
	| Poster View
Sort by 
%a{:href => "/posterview/title"}Title
|
%a{:href => "/posterview/release_year"}Year Released
|
%a{:href => "/posterview/length"}Length
%br
-movies.each do |movie|
	-if load_limit > 10
		%br
		Poster Collection Not Complete. 10 Posters added every time you load this page.
		-break
	- poster = ''
	-if $Poster_urls[movie.title].nil?
		-load_limit += 1
		-result = YAML.load(open(URI.escape("http://api.themoviedb.org/2.1/Movie.search/en/yaml/"+$API_KEY+'/'+movie.title)).read)[0]
		-if result.is_a? Hash
			-result['posters'].each do |image|
				-poster = image['image']['url'] if image['image']['size'] == "cover"
		-$Poster_urls[movie.title]=poster unless poster == ''
	-else
		- poster = $Poster_urls[movie.title]
	%a{:href => "/movie/"+movie.title}
		%img{:src => poster}