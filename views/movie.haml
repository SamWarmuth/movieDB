- movie = Movie.get(params[:key])
- return haml("= 'ERROR: Movie #{params[:key]} not found' if movie.nil?")
- m = YAML.load(open(URI.escape("http://api.themoviedb.org/2.1/Movie.search/en/yaml/"+$API_KEY+'/'+movie.title)).read)
- result = YAML.load(open("http://api.themoviedb.org/2.1/Movie.getInfo/en/yaml/"+ $API_KEY + '/' + m[0]["id"].to_s).read)[0]
- poster = ''
-if result.is_a? Hash
	-result['posters'].each do |image|
		-poster = image['image']['url'] if image['image']['size'] == "cover"
%h1
	= movie.title
	-if movie.mpaa_rating != ""
		(#{movie.mpaa_rating})
%h2	
	= movie.release_year
	\-
	-unless movie.director.nil?
		%a{:href => "/director/#{movie.director.name}"} #{movie.director.name}
	= movie.length
	minutes
%table{:style => "width: 30em; margin-left: auto; margin-right: auto; text-align: left;"}
	%tr
		%td
			-unless poster == ''
				%img{:src => poster}
		%td
			= movie.plot
-actors = movie.actors
-unless actors[0].nil?
	%h2
		Actors
		%br
	%h3
		-actors.each do |actor|
			%a{:href => "/actor/#{actor.name}", :class =>"toggle_box", :id => "c#{jQ_clean(actor.name)}"} #{actor.name}
			%br
			%div{:id => "#{jQ_clean(actor.name)}", :class => "hideme", :style => "font: 14px/16px helvetica; width:400px; margin: auto;-moz-border-radius: 10px; -webkit-border-radius: 10px; background-color: #eee; padding: 5px;"}
				Performed in
				-actor.movies.each do |mov|
					%a{:href => "/movie/#{mov.title}"} #{mov.title},
				%br
				%a{:href => "/actor/#{actor.name}"} Full Info
%p
	%a{:href => "/editMovie/#{movie.title}"} Edit Movie		
	|
	%a{:href => "/deleteMovie/#{movie.title}"} Delete Movie